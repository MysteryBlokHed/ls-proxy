// ==UserScript==
// @name        ls-proxy
// @descripton  Wrapper around localStorage to easily store JSON objects
// @version     0.2.0
// @author      Adam Thompson-Sharpe
// @license     MIT
// @homepageURL https://gitlab.com/MysteryBlokHed/ls-proxy
// ==/UserScript==
(()=>{"use strict";var e={677:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.keys=(e,t)=>Object.keys(e).every((e=>t.includes(e)))&&t.every((t=>t in e)),e.types=(e,t)=>Object.entries(e).every((([e,r])=>typeof r===t[e]))}(r||(r={})),t.default=r}},t={};function r(o){var a=t[o];if(void 0!==a)return a.exports;var l=t[o]={exports:{}};return e[o](l,l.exports,r),l.exports}var o={};(()=>{var e=o;Object.defineProperty(e,"__esModule",{value:!0}),e.storeSeparate=e.storeObject=e.Validations=void 0;var t=r(677);Object.defineProperty(e,"Validations",{enumerable:!0,get:function(){return t.default}});e.storeObject=function(e,t,r={}){const{checkGets:o,partial:l,validate:n,modify:s,parse:c,stringify:i}=(({checkGets:e,partial:t,validate:r,modify:o,parse:a,stringify:l})=>({checkGets:null==e||e,partial:null!=t&&t,validate:null!=r?r:()=>!0,modify:null!=o?o:e=>e,parse:null!=a?a:JSON.parse,stringify:null!=l?l:JSON.stringify}))(r),g=(t,r="set")=>a(n,s,t,r,e),f=e=>{const t=c(e);return g(t,"get")},u=e=>i(g(e)),d=(e,r=!0)=>{let o={};return Object.keys(t).forEach((a=>{var l;return o[a]=r?null!==(l=e[a])&&void 0!==l?l:t[a]:e[a]})),o};let y=Object.assign({},t);if(localStorage[e])if(l){const t=c(localStorage[e]);y=d(t);const r=g(y);localStorage[e]=i(Object.assign(Object.assign({},t),r))}else y=f(localStorage[e]);else localStorage[e]=u(t);return new Proxy(y,{set(t,r,o,a){const n=Reflect.set(t,r,o,a);if(l){const r=g(t);localStorage[e]=i(Object.assign(Object.assign({},c(localStorage[e])),r))}else localStorage[e]=u(t);return n},get(r,a,n){var s;return o&&(l?(r[a]=g(d(c(localStorage[e]),!1),"get")[a],g(r,"get")):r[a]=null!==(s=f(localStorage[e])[a])&&void 0!==s?s:t[a]),Reflect.get(r,a,n)}})};const a=(e,t,r,o,a)=>{const l=new TypeError("get"===o?`Validation failed while parsing ${a} from localStorage`:`Validation failed while setting to ${a} in localStorage`),n=e(r);if("boolean"==typeof n){if(!n)throw l}else if(Array.isArray(n)&&!n[0])throw 2===n.length?n[1]:l;return t(r)};e.storeSeparate=function(e,t={}){const{id:r,checkGets:o}=(({id:e,checkGets:t})=>({id:e,checkGets:null==t||t}))(t),a=Object.assign({},e);for(const[t,o]of Object.entries(e)){const e=l(t,r);localStorage[e]?a[t]=localStorage[e]:localStorage[e]=o}return new Proxy(a,{set:(e,t,o,a)=>(localStorage[l(t,r)]=o,Reflect.set(e,t,o,a)),get(t,a,n){var s;return o&&(t[a]=null!==(s=localStorage[l(a,r)])&&void 0!==s?s:e[a]),Reflect.get(t,a,n)}})};const l=(e,t)=>t?`${t}.${e}`:e})(),window.LSProxy=o})();